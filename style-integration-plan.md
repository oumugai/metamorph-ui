# MetaMorph UI スタイル統合計画

## 目的
コンポーネントごとにスタイルを自己完結させ、グローバルスタイルのインポートを不要にする

## アプローチ

### 1. スタイルの組み込み方法

#### withStyles高階コンポーネントの作成
```typescript
// 計画中のAPI
export function withStyles<T>(Component: Component<T>, styles: string): Component<T> {
  return (props) => {
    // スタイルを動的に注入
    injectStyles(styles);
    return <Component {...props} />;
  };
}
```

#### コンポーネントでの使用例
```typescript
// 計画中の実装方法
export const Button = withStyles((props: ButtonProps) => {
  // コンポーネントの実装
}, buttonStyles);
```

### 2. ビルド設定の最適化

#### vite.config.tsの変更点
- CSSモジュールの設定を最適化
- スタイルのバンドル方法を変更
- コード分割の設定を調整

### 3. 実装手順

1. スタイル注入ユーティリティの作成
   - スタイルの重複チェック
   - パフォーマンスの最適化
   - メモリリーク防止

2. コンポーネントの修正
   - 各コンポーネントにスタイルを統合
   - グローバルスタイルの分解と再配置
   - 依存関係の整理

3. ビルドプロセスの更新
   - CSS抽出の最適化
   - バンドルサイズの最適化
   - パッケージ構造の改善

## 期待される効果

1. 使用性の向上
   - グローバルスタイルのインポートが不要
   - コンポーネントの自己完結性が向上
   - 設定の簡素化

2. パフォーマンスの最適化
   - 必要なスタイルのみが読み込まれる
   - バンドルサイズの最適化
   - 初期読み込みの高速化

## 技術的な考慮事項

1. スタイルの重複防止
   - スタイルハッシュの生成と管理
   - キャッシュ機構の実装

2. SSRサポート
   - サーバーサイドでのスタイル抽出
   - ハイドレーション対応

3. TypeScript対応
   - 型安全性の確保
   - コンポーネントの型推論の維持

## 次のステップ

1. Codeモードに切り替えて実装を開始
2. 各コンポーネントの移行
3. テストの作成と実行
4. ドキュメントの更新